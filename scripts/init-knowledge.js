const fs = require('fs');
const path = require('path');

const knowledgeDir = path.join(__dirname, '..', 'knowledge');

const dirs = [
  'core',
  'network',
  'venture',
  'sales',
  'platform',
  'planning',
  'communication',
  'log',
];

const files = {
  'CLAUDE.md': null, // generated separately
  'core/identity.md': `---
Load for: identity, about me, who am I, background, bio
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Identity

Fill this in with your personal identity information.

- Name:
- Role:
- Location:
- Background:
- Values:
`,
  'core/team.md': `---
Load for: team, cofounder, employees, partners, collaborators
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Team

List your team members, collaborators, and key partners here.

## Key People

-
`,
  'network/_schema.jsonl': '{"_schema": "contact", "_version": "1.0", "_description": "One entry per person in network"}\n',
  'network/example-contact.jsonl': '{"_schema": "contact", "_version": "1.0", "_description": "One entry per person in network"}\n{"date": "' + new Date().toISOString() + '", "name": "Jane Example", "notes": "Met at conference. Works in AI. Interested in collaboration."}\n',
  'venture/example-venture.md': `---
Load for: venture, startup, project, business
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Example Venture

Replace this with your actual venture information.

## Overview

-

## Status

-

## Key Metrics

-
`,
  'sales/methodology.md': `---
Load for: sales, methodology, selling, process, close
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Sales Methodology

Document your sales approach here.

## Process

1.
2.
3.
`,
  'sales/objections.md': `---
Load for: objections, pushback, concerns, sales objections
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Objection Handling

## Common Objections

-
`,
  'sales/icp.md': `---
Load for: icp, ideal customer, target market, persona, audience
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Ideal Customer Profile

## Demographics

-

## Pain Points

-

## Buying Triggers

-
`,
  'platform/linkedin.md': `---
Load for: linkedin, professional network, linkedin strategy
Last updated: ${new Date().toISOString().split('T')[0]}
---

# LinkedIn Strategy

## Content Pillars

-

## Posting Cadence

-
`,
  'platform/twitter.md': `---
Load for: twitter, x, tweets, social media
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Twitter / X Strategy

## Content Pillars

-

## Posting Cadence

-
`,
  'planning/goals.md': `---
Load for: goals, objectives, okrs, targets, milestones
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Goals

## Current Quarter

-

## This Year

-
`,
  'planning/pipeline.md': `---
Load for: pipeline, deals, opportunities, prospects, funnel
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Pipeline

## Active Deals

-

## Prospects

-
`,
  'communication/style.md': `---
Load for: communication style, tone, voice, writing style
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Communication Style

## Tone

-

## Key Phrases

-

## Avoid

-
`,
  'communication/templates.md': `---
Load for: templates, email templates, message templates, outreach
Last updated: ${new Date().toISOString().split('T')[0]}
---

# Templates

## Cold Outreach

-

## Follow Up

-

## Introduction

-
`,
  'log/decisions.jsonl': '{"_schema": "decision", "_version": "1.0", "_description": "Append-only log of key decisions with reasoning"}\n',
  'log/failures.jsonl': '{"_schema": "failure", "_version": "1.0", "_description": "Append-only log of failures with root cause analysis"}\n',
};

// Create directories
for (const dir of dirs) {
  const fullPath = path.join(knowledgeDir, dir);
  if (!fs.existsSync(fullPath)) {
    fs.mkdirSync(fullPath, { recursive: true });
    console.log(`Created directory: knowledge/${dir}`);
  }
}

// Create files (only if they don't already exist)
for (const [filePath, content] of Object.entries(files)) {
  if (content === null) continue; // skip CLAUDE.md, generated by server
  const fullPath = path.join(knowledgeDir, filePath);
  if (!fs.existsSync(fullPath)) {
    fs.writeFileSync(fullPath, content, 'utf-8');
    console.log(`Created file: knowledge/${filePath}`);
  }
}

console.log('Knowledge directory initialized.');
